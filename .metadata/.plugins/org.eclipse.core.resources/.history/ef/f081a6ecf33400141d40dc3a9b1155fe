package gitter;

import java.lang.reflect.Type;
import java.util.ArrayList;
import java.util.Collection;

import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;

import get.Command;

public class GetRooms {
	public static String getRooms() throws Exception
	{
		String command = "curl -i -H \"Accept: application/json\" -H \"Authorization: Bearer f942da113703b8fb345a9277945098757265255e\" \"https://api.gitter.im/v1/rooms\" -k";
		String[] jsons = Command.execCommand(command);
		String json = null;

		if(jsons[0] == "HTTP/1.1 200 OK")
		{
			json = jsons[14];
		}else if(jsons[0] == null){
			System.out.println("Error CURL[command: \"curl can't use\"]");
		}else{
			System.out.println("Error CURL[command: \"curl gitter api\"]");
		}

		return json;
	}

	public static Room[] jsonToListRooms(String json)
	{
		Gson gson = new Gson();
		Room[] rooms;
		Type collectionType = new TypeToken<Collection<Room>>(){}.getType();

		rooms = gson.fromJson(json.toString(),collectionType);

		return rooms;
	}
}
